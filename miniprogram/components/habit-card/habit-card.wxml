<!-- components/habit-card/habit-card.wxml -->
<view
  class="habit-card {{isCheckedToday ? 'checked' : ''}} {{animating ? 'animating' : ''}}"
  style="border-left: 8rpx solid {{habit.color || '#6C5CE7'}}"
  bindtap="onTap"
  bindlongpress="onLongPress"
>
  <!-- ä¸»è¦å†…å®¹åŒºåŸŸ -->
  <view class="card-main">
    <!-- å·¦ä¾§ï¼šå›¾æ ‡ -->
    <view class="habit-icon-wrapper" style="background-color: {{habit.color || '#6C5CE7'}}20">
      <text class="habit-icon">{{habit.icon || 'â­'}}</text>
    </view>

    <!-- ä¸­é—´ï¼šä¿¡æ¯ -->
    <view class="habit-info">
      <view class="habit-name-row">
        <text class="habit-name">{{habit.name}}</text>
        <!-- è¿ç»­æ‰“å¡å¾½ç«  -->
        <view wx:if="{{streak > 0}}" class="streak-badge">
          <text class="streak-icon">ğŸ”¥</text>
          <text class="streak-count">{{streak}}</text>
        </view>
      </view>

      <!-- æè¿°æˆ–ç›®æ ‡ -->
      <view class="habit-meta">
        <text wx:if="{{habit.targetValue && habit.unit}}" class="habit-target">
          ç›®æ ‡: {{habit.targetValue}}{{habit.unit}}
        </text>
        <text wx:elif="{{habit.description}}" class="habit-desc">{{habit.description}}</text>
        <text wx:else class="habit-desc">æ¯å¤©åšæŒ</text>
      </view>

      <!-- ä»Šæ—¥æ‰“å¡ä¿¡æ¯ -->
      <view wx:if="{{checkIn && checkIn.completed}}" class="today-info">
        <text wx:if="{{checkIn.value}}" class="today-value">
          ä»Šæ—¥: {{checkIn.value}}{{habit.unit || ''}}
        </text>
        <text wx:if="{{checkIn.note}}" class="today-note">{{checkIn.note}}</text>
      </view>
    </view>

    <!-- å³ä¾§ï¼šæ‰“å¡æŒ‰é’® -->
    <view class="check-btn-wrapper" catchtap="onQuickCheckIn">
      <view class="check-btn {{isCheckedToday ? 'checked' : ''}}" style="border-color: {{habit.color || '#6C5CE7'}}; {{isCheckedToday ? 'background-color:' + (habit.color || '#6C5CE7') : ''}}">
        <text class="check-icon">{{isCheckedToday ? 'âœ“' : ''}}</text>
      </view>
      <text class="check-text">{{isCheckedToday ? 'å·²å®Œæˆ' : 'æ‰“å¡'}}</text>
    </view>
  </view>
</view>
